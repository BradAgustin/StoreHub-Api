<div class="p-3">
  <div class="flex justify-content-between align-items-center mb-3">
    <div>
        <h1 class="m-0">Inventario</h1>
        <span *ngIf="currentCategory" class="text-sm text-gray-500">
            Filtrado por categoría ID: {{ currentCategory }} 
            <a routerLink="/inventory/list" class="text-primary no-underline ml-2 cursor-pointer">(Ver todos)</a>
        </span>
    </div>
    <button mat-raised-button color="primary" routerLink="/inventory/new">
      <mat-icon>add</mat-icon> Agregar Producto
    </button>
  </div>
  
  <mat-divider class="mb-3"></mat-divider>
  
  <div class="grid">
    <div *ngFor="let product of products" class="col-12 sm:col-6 md:col-4">
      <mat-card class="h-full shadow-2 hover:shadow-4 transition-duration-200">
        
        <mat-card-header>
          <div mat-card-avatar class="example-header-image">
            <mat-icon class="text-4xl text-gray-500">inventory_2</mat-icon>
          </div>
          <mat-card-title>{{ product.name }}</mat-card-title>
          <mat-card-subtitle>{{ product.sku }}</mat-card-subtitle>
        </mat-card-header>

        <mat-card-content class="mt-3">
          <div class="text-3xl text-primary font-bold mb-2">{{ product.price | currency }}</div>
          <div class="text-gray-600 mb-2">Stock: <strong>{{ product.stock }}</strong></div>
          <div class="text-sm text-gray-400 mb-3">Categoría: {{ product.category_name || 'N/A' }}</div>
          
          <div class="flex gap-2">
            <button mat-stroked-button color="accent" class="flex-1" (click)="openAdjustModal(product)">
               <mat-icon>compare_arrows</mat-icon> Ajustar
            </button>
            
            <button mat-flat-button 
                    class="text-white flex-1 transition-colors"
                    [style.background-color]="product.is_active ? '#2e7d32' : '#c62828'"
                    (click)="toggleStatus(product)">
              {{ product.is_active ? 'Activo' : 'Inactivo' }}
            </button>
          </div>
        </mat-card-content>

        <mat-divider></mat-divider>

        <mat-card-actions align="end">
          <button mat-button color="primary" (click)="onEdit(product.id!)">
            <mat-icon>edit</mat-icon> Editar
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
  </div>

  <div *ngIf="products.length === 0" class="flex flex-column align-items-center justify-content-center p-5 text-gray-500">
    <mat-icon class="text-6xl mb-2">inbox</mat-icon>
    <p>No se encontraron productos.</p>
    <a *ngIf="currentCategory" routerLink="/inventory/list" class="text-primary">Ver todo el inventario</a>
  </div>
</div>
